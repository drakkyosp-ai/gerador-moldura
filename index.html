<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gerador de Foto com Moldura</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex justify-center">

  <div class="w-full max-w-md p-4 space-y-4">

    <h1 class="text-xl font-semibold text-center">
      Gerador de Foto com Moldura
    </h1>

    <!-- Upload -->
    <input
      type="file"
      accept="image/*"
      id="upload"
      class="w-full text-sm
             file:bg-blue-600 file:text-white
             file:px-4 file:py-2 file:rounded
             file:border-0"
    />

    <!-- Preview -->
    <div class="bg-white rounded-lg shadow p-2 flex justify-center">
      <canvas
        id="canvas"
        class="w-full h-auto rounded"
        style="aspect-ratio: 1080 / 1350;"
      ></canvas>
    </div>

    <!-- Download -->
    <button
      id="download"
      class="w-full bg-green-600 text-white py-3 rounded-lg font-medium"
    >
      Baixar imagem
    </button>

  </div>

  <script>
    const upload = document.getElementById("upload");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const downloadBtn = document.getElementById("download");

    // ðŸ”’ TAMANHO FIXO DA MOLDURA
    const FRAME_WIDTH = 1080;
    const FRAME_HEIGHT = 1350;

    canvas.width = FRAME_WIDTH;
    canvas.height = FRAME_HEIGHT;

    let userImage = null;

    // ðŸ§© MOLDURA FIXA (jÃ¡ carregada)
    const frameImage = new Image();
    frameImage.src = "frames/frame1.png"; // ðŸ”´ ajuste o caminho se necessÃ¡rio
    frameImage.onload = draw;

    // Upload da imagem do usuÃ¡rio
    upload.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const img = new Image();
      img.onload = () => {
        userImage = img;
        draw();
      };
      img.src = URL.createObjectURL(file);
    });

    function draw() {
      // fundo
      ctx.fillStyle = "#ffffff";
      ctx.fillRect(0, 0, FRAME_WIDTH, FRAME_HEIGHT);

      // ðŸ–¼ï¸ imagem do usuÃ¡rio (sempre contida no frame)
      if (userImage) {
        const scale = Math.min(
          FRAME_WIDTH / userImage.width,
          FRAME_HEIGHT / userImage.height
        );

        const width = userImage.width * scale;
        const height = userImage.height * scale;

        const x = (FRAME_WIDTH - width) / 2;
        const y = (FRAME_HEIGHT - height) / 2;

        ctx.drawImage(userImage, x, y, width, height);
      }

      // ðŸ§© moldura fixa SEM distorÃ§Ã£o
      if (frameImage.complete) {
        ctx.drawImage(frameImage, 0, 0, FRAME_WIDTH, FRAME_HEIGHT);
      }
    }

    // Download
    downloadBtn.addEventListener("click", () => {
      const a = document.createElement("a");
      a.download = "imagem-com-moldura.png";
      a.href = canvas.toDataURL("image/png");
      a.click();
    });
  </script>

</body>
</html>